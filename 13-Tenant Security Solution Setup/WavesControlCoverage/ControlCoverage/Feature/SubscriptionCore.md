## SubscriptionCore

| Control Id | Description | API & Property | Logic |
|------------|-------------------------|----------------|-------|
| Azure_Subscription_Config_ASC_Enable_AutoProvisioning | Auto Provisioning must be set to ON in Azure Security Center. | <b>Used ARM API(s):</b><br>/subscriptions/{subscriptionId}/providers/Microsoft.Security/<br>autoProvisioningSettings/default?api-version=2017-08-01-preview<br><br><b>Used Property:</b><br>autoProvision | <b>Passed: </b><br>Auto Provisioning is enabled.<br><b>Failed: </b><br>Auto Provisioning is not enabled or if security center provider is not registered. |
| Azure_Subscription_AuthZ_Remove_Deprecated_Accounts | Deprecated/stale accounts must not be present on the subscription. | <b>Used ARM API to get role assignment at scope:</b> <br>/{scope}/providers/Microsoft.Authorization/roleAssignments?<br>api-version=2018-01-01-preview<br><b>Used Property:</b> principalId<br><br><b>Used PIM API to get role assignment:</b> /beta/privilegedAccess/azureResources/resources/<br>{uniquePIMIdentifier}/roleAssignments?$expand=subject,<br>roleDefinition($expand=resource)&$filter=(memberType%20ne%20'{filterCondition}')<br><b>Used Property:</b><br> subject/id<br><br><b>Used ARM API:</b><br>/subscriptions/{subscriptionId}/providers/Microsoft.Security<br>/assessments?api-version=2020-01-01<br><br><b>Used Property:</b><br>id, name, resourceDetails/Id, displayName, status/code, status, additionalData| <b>Passed: </b><br>No deprecated account is found at subscription scope (in both ASC and Reader scan).<br><b>Failed: </b><br>Deprecated account is found at subscription scope (in any one of ASC and Reader scan). |
| Azure_Subscription_Config_ASC_Tier | Standard tier must be enabled for Azure Security Center. | <b>Used ARM API:</b><br>/subscriptions/{subscriptionId}/providers/Microsoft.Security/<br>pricings?api-version=2018-06-01<br><br><b>Used Property:</b><br>pricingTier | <b>Passed: </b><br>All required resource types are configured with ASC standard tier.<br><b>Failed: </b><br>Any of resource types is not configured with ASC standard tier or if security center provider is not registered. |
| Azure_Subscription_AuthZ_Dont_Use_NonAD_Identities | Do not grant permissions to external accounts (i.e., accounts outside the native directory for the subscription). | <b>Used PIM API to get role assignment:</b><br> /beta/privilegedAccess/azureResources/resources/<br>{uniquePIMIdentifier}/roleAssignments?$expand=subject,<br>roleDefinition($expand=resource)&$filter=(memberType%20ne%20'{filterCondition}')<br><b>Used Property:</b><br>subject/principalName<br><br><b>Used ARM API to get classic role assignment:</b><br>subscriptions/{subscriptionId}/providers/Microsoft.Authorization<br>/classicAdministrators?api-version=2015-06-01<br><b>Used Property:</b><br> emailAddress | <b>Passed: </b><br>No external account is found at subscription scope.<br><b>Failed: </b><br>External account is found at subscription scope.<br><b>Verify: </b><br>RBAC result not found (sufficient data is not available for evaluation). |
